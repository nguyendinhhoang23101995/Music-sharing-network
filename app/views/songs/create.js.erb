<% if @song.errors.empty? %>
new_song = "<%= j render 'song', song: @song %>";
$('#songs').append(new_song);
$('#flash-errors').html("<%= j render 'shared/flash', object: @song %>");
animated();
<% else %>
$('#flash-errors').html("<%= j render 'shared/flash', object: @song %>");
$('#error_explanation').transition('error');
$('.close.red').click();
<% end %>
$('.ui.form').removeClass('loading');
$('.play-music').remove('click');
$('.play-music').click(function() {
    music_player.jPlayer("setMedia", {
        title: $(this).attr('data-title'),
        mp3: $(this).attr('data-file')
    });
    music_player.jPlayer("play", 1);
});

function animated() {
    $('#error_explanation').html("");
    $('#song-<%= @song.id %>').addClass('animated flipInX');
    $('.close.red').click();
}